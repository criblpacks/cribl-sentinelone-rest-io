in_sentinelone_alerts:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: "*/5 * * * *"
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: get
      pagination:
        type: response_body
        maxPages: 0
        attribute:
          - pagination.nextCursor
        lastPageExpr: "!pagination.nextCursor.includes('a')"
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/cloud-detection\
        /alerts'\r\n"
      clientSecretParamValue: ""
      collectRequestParams:
        - name: createdAt__gte
          value: 'C.Time.strftime(earliest ? earliest : Date.now()/1000 -
            30*24*60*60,"%Y-%m-%dT%H:%M:%S.%fZ") '
        - name: createdAt__lte
          value: 'C.Time.strftime(latest ? latest : Date.now()/1000 -
            60,"%Y-%m-%dT%H:%M:%S.%fZ") '
        - name: limit
          value: "1000"
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-alerts'"
  savedState: {}
  notifications: []
  description: Use for non-Singularity Operations Center Alerts
in_sentinelone_agents:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: 5 4,18 * * *
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking: {}
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: get
      pagination:
        type: response_body
        maxPages: 0
        attribute:
          - nextCursor
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/agents'\r\n"
      clientSecretParamValue: ""
      collectRequestParams: []
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-agents'"
  savedState: {}
  notifications: []
  description: Use for non-Singularity Operations Center Agent Inventory
in_sentinelone_vulnerabilities:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: 2 */2 * * *
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: get
      pagination:
        type: response_body
        maxPages: 0
        attribute:
          - pagination.nextCursor
        lastPageExpr: "!pagination.nextCursor.includes('a')"
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/application-man\
        agement/risks'\r\n"
      clientSecretParamValue: ""
      collectRequestParams:
        - name: limit
          value: "1000"
        - name: detectionDate__gte
          value: 'C.Time.strftime(earliest ? earliest : Date.now()/1000 -
            30*24*60*60,"%Y-%m-%dT%H:%M:%S.%fZ") '
        - name: detectionDate__lte
          value: 'C.Time.strftime(latest ? latest : Date.now()/1000 -
            60,"%Y-%m-%dT%H:%M:%S.%fZ") '
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-vulnerabilities'"
  savedState: {}
  notifications: []
  description: Use for non-Singularity Operations Center Vulnerabilities
in_sentinelone_alerts_graphql:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: "*/5 * * * *"
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: post
      pagination:
        type: none
        maxPages: 0
        attribute:
          - pagination.nextCursor
        lastPageExpr: "!pagination.nextCursor.includes('a')"
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/unifiedalerts/g\
        raphql'\r\n"
      clientSecretParamValue: ""
      collectRequestParams:
        - name: query
          value: '`query criblAlerts {    alerts (first: 1000, filters: [{fieldId:
            "updatedAt", dateTimeRange: {end: ` + `${latest ? latest :
            Math.round(Date.now()/1000)}` + `, start: ` +  `${earliest ?
            earliest : Math.round(Date.now()/1000 - 30*24*60*60)}` + `,
            startInclusive: true}}]){      edges { node { analystVerdict
            analytics { category name typeValue uid } asset { agentUuid
            agentVersion assetTypeClassifier category connectivityToConsole id
            lastLoggedInUser name osType osVersion pendingReboot policy
            subcategory } assignee { email fullName userId } attackSurfaces
            classification confidenceLevel createdAt dataSources description
            detectedAt detectionSource { product vendor } detectionTime { asset
            { agentVersion consoleIpAddress domain ipV4 ipV6 lastLoggedInUser
            osName osRevision osType policy subscriptionTime } attacker { host
            ip } cloud { accountId cloudProvider image instanceId instanceSize
            location network tags } kubernetes { clusterName containerId
            containerImageName containerLabels containerName controllerLabels
            controllerName controllerType namespaceLabels namespaceName
            nodeLabels nodeName podLabels podName } scope { accountId
            accountName groupName siteName } targetUser { domain emailAddress
            name } } externalId firstSeenAt id lastSeenAt name noteExists
            process { cmdLine file { certSubject md5 name path sha1 sha256 }
            parentName } realTime { scope { account { id name } group { id name
            } site { id name } } } result severity status storylineId ticketId
            updatedAt } } } } `'
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
      collectBody: "`query criblAlerts {    alerts {      edges {        node
        {          id          asset{            agentUuid            assetType\
        Classifier            category            id            lastLoggedInUse\
        r            name            osType            osVersion            sub\
        category          }          createdAt          detectedAt          att\
        ackSurfaces          classification          confidenceLevel          d\
        ataSources          description          detectionSource{            pr\
        oduct          }          name          status          analystVerdict          \
        assignee
        {            fullName            email          }        }      },      \
        totalCount    }  }`"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-alerts-graphql'"
  savedState: {}
  notifications: []
  description: Use for Singularity Operations Center Alerts
in_sentinelone_vulnerabilities_graphql:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: 2 */2 * * *
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: post
      pagination:
        type: none
        maxPages: 0
        attribute:
          - pagination.nextCursor
        lastPageExpr: "!pagination.nextCursor.includes('a')"
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/xspm/findings/v\
        ulnerabilities/graphql'\r\n"
      clientSecretParamValue: ""
      collectRequestParams:
        - name: query
          value: '`query criblVulberabilities { vulnerabilities ( filters: [{fieldId:
            "detectedAt", dateTimeRange: {end: ` + `${latest ? latest :
            Math.round(Date.now()/1000)}` + `, start: ` +  `${earliest ?
            earliest : Math.round(Date.now()/1000 - 120*24*60*60)}` + `,
            startInclusive: true}}]){ edges { node { analystVerdict asset {
            category cloudInfo { accountId accountName providerName region
            resourceId resourceLink } criticality domain id kubernetesInfo {
            cluster clusterId namespace } name osType privileged subcategory
            type } assignee { deleted email fullName id } cve { epssScore
            exploitMaturity exploitedInTheWild id publishedDate remediationLevel
            reportConfidence score score } detectedAt exclusionPolicyId id name
            product scope { account { id name } group { id name } site { id name
            } } severity software { fixVersion name type vendor version } status
            vendor } } }}`'
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
      collectBody: "`query criblAlerts {    alerts {      edges {        node
        {          id          asset{            agentUuid            assetType\
        Classifier            category            id            lastLoggedInUse\
        r            name            osType            osVersion            sub\
        category          }          createdAt          detectedAt          att\
        ackSurfaces          classification          confidenceLevel          d\
        ataSources          description          detectionSource{            pr\
        oduct          }          name          status          analystVerdict          \
        assignee
        {            fullName            email          }        }      },      \
        totalCount    }  }`"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-vulnerabilities-graphql'"
  savedState: {}
  notifications: []
  description: Use for Singularity Operations Center Vulnerabilities
in_sentinelone_assets_surface:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: 5 4,18 * * *
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: "0"
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: false
      timestampTimezone: UTC
      earliest: -6m@m
      latest: -1m@m
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
        itemList:
          - cloud-detection/alerts
      collectMethod: get
      pagination:
        type: response_body
        maxPages: 0
        attribute:
          - pagination.nextCursor
        lastPageExpr: "!pagination.nextCursor.includes('a')"
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: true
      decodeUrl: true
      rejectUnauthorized: false
      captureHeaders: false
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      loginUrl: "'https://usea1-tt01.sentinelone.net'\r\n"
      loginBody: '`{ "username": "${username}", "password": "${password}" }`'
      authHeaderKey: Authorization
      authHeaderExpr: "`Bearer ${token}`"
      tokenRespAttribute: token
      clientSecretParamName: client_secret
      collectUrl: "'https://YOUR_S1_SITE.sentinelone.net/web/api/v2.1/xdr/assets/surf\
        ace/endpoint'\r\n"
      clientSecretParamValue: ""
      collectRequestParams: []
      collectRequestHeaders:
        - name: Authorization
          value: "'ApiToken YOUR_API_TOKEN'"
    destructive: false
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    breakerRulesets:
      - SentinelOne API Ruleset
    metadata:
      - name: __packsource
        value: "'cribl-sentinelone-rest-io.sentinelone-assets'"
  savedState: {}
  notifications: []
  description: Use for Singularity Operations Center Assets
